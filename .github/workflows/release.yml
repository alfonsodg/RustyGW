name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    name: Build and Release
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Install Rust
      uses: dtolnay/rust-toolchain@stable
      
    - name: Build release binary
      run: cargo build --release
      
    - name: Create release
      uses: softprops/action-gh-release@v1
      with:
        files: |
          target/release/main
        body: |
          ## RustyGW Release
          
          ### Features
          - High-performance API Gateway written in Rust
          - Rate limiting, authentication, caching
          - Circuit breaker pattern
          - WebSocket support
          - Docker support with demo
          
          ### Usage
          ```bash
          chmod +x main
          ./main
          ```
          
          ### Configuration
          Requires `gateway.yaml` and `api_keys.yaml` in the same directory.
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
