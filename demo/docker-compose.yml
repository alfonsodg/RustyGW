version: '3.8'

services:
  gateway:
    build: .
    ports:
      - "8094:8094"
    depends_on:
      - users-service
      - products-service
      - orders-service
      - frontend
    volumes:
      - ./gateway.yaml:/app/gateway.yaml
      - ./api_keys.yaml:/app/api_keys.yaml

  users-service:
    build: ./demo/backend-users
    ports:
      - "8091:8091"
    environment:
      - PORT=8091

  products-service:
    build: ./demo/backend-products
    ports:
      - "8092:8092"
    environment:
      - PORT=8092

  orders-service:
    build: ./demo/backend-orders
    ports:
      - "8093:8093"
    environment:
      - PORT=8093

  frontend:
    image: python:3.13-slim
    ports:
      - "8090:8090"
    volumes:
      - ./demo/frontend:/app
    working_dir: /app
    command: python -m http.server 8090
